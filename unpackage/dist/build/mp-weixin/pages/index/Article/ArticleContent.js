"use strict";const t=require("../../../common/vendor.js"),i={data:()=>({article:{},isLiked:!1,isFavorited:!1}),onLoad(){const i=getCurrentPages(),e=i[i.length-1].options.article_id;e?this.fetchArticle(e):t.index.showToast({title:"文章 ID 无效",icon:"none"})},methods:{fetchArticle(i){t.index.request({url:`http://localhost:3000/api/articles/${i}`,method:"GET",success:i=>{i.data.success?(this.article=i.data.data,this.isLiked=this.article.is_liked||!1,this.isFavorited=this.article.is_favorited||!1):t.index.showToast({title:"获取文章失败",icon:"none"})},fail:()=>{t.index.showToast({title:"请求失败，请稍后重试",icon:"none"})}})},toggleLike(){this.isLiked?this.unlikeArticle():this.likeArticle()},likeArticle(){t.index.request({url:`http://localhost:3000/api/articles/${this.article.article_id}/like`,method:"POST",success:i=>{i.data.success?(this.article.likes+=1,this.isLiked=!0):t.index.showToast({title:"点赞失败",icon:"none"})},fail:()=>{t.index.showToast({title:"请求失败，请稍后重试",icon:"none"})}})},unlikeArticle(){t.index.request({url:`http://localhost:3000/api/articles/${this.article.article_id}/unlike`,method:"POST",success:i=>{i.data.success?(this.article.likes-=1,this.isLiked=!1):t.index.showToast({title:"取消点赞失败",icon:"none"})},fail:()=>{t.index.showToast({title:"请求失败，请稍后重试",icon:"none"})}})},toggleFavorite(){this.isFavorited?this.unfavoriteArticle():this.favoriteArticle()},favoriteArticle(){t.index.request({url:`http://localhost:3000/api/articles/${this.article.article_id}/favorite`,method:"POST",success:i=>{i.data.success?(this.article.favorites+=1,this.isFavorited=!0):t.index.showToast({title:"收藏失败",icon:"none"})},fail:()=>{t.index.showToast({title:"请求失败，请稍后重试",icon:"none"})}})},unfavoriteArticle(){t.index.request({url:`http://localhost:3000/api/articles/${this.article.article_id}/unfavorite`,method:"POST",success:i=>{i.data.success?(this.article.favorites-=1,this.isFavorited=!1):t.index.showToast({title:"取消收藏失败",icon:"none"})},fail:()=>{t.index.showToast({title:"请求失败，请稍后重试",icon:"none"})}})}}};const e=t._export_sfc(i,[["render",function(i,e,s,o,a,c){return{a:t.t(a.article.title),b:t.t(a.article.publish_date),c:t.t(a.article.author),d:t.t(a.article.content),e:t.t(a.article.likes),f:a.isLiked?1:"",g:t.o(((...t)=>c.toggleLike&&c.toggleLike(...t))),h:t.t(a.article.favorites),i:a.isFavorited?1:"",j:t.o(((...t)=>c.toggleFavorite&&c.toggleFavorite(...t)))}}],["__scopeId","data-v-cc2d5436"]]);wx.createPage(e);
