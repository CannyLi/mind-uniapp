"use strict";const e=require("../../../common/vendor.js"),t=require("../../../stores/modules/userStore.js"),a={setup(){const a=t.useUserStore();a.initUser();const o=e.ref("");return e.onMounted((()=>{a.loginStatus||(e.index.navigateTo({url:"/pages/login/login"}),e.index.showToast({title:"请先登录！",icon:"none",duration:2e3}))})),{feedback:o,maxFeedbackLength:1e3,submitFeedback:async()=>{if(o.value.trim())try{const t=await e.index.request({url:"http://localhost:3000/api/feedback",method:"POST",data:{users_id:a.userInfo.users_id,feedback:o.value}});200===t.statusCode&&t.data.success?(e.index.showToast({title:"反馈提交成功",icon:"success"}),o.value="",e.index.navigateBack({delta:1})):e.index.showToast({title:"提交反馈失败",icon:"none"})}catch(t){console.error("提交反馈失败:",t),e.index.showToast({title:"提交失败，请稍后再试",icon:"none"})}else e.index.showToast({title:"请输入反馈内容",icon:"none",duration:2e3})}}}};const o=e._export_sfc(a,[["render",function(t,a,o,s,n,i){return{a:e.o([e=>s.feedback=e.detail.value,(...e)=>t.updateFeedbackLength&&t.updateFeedbackLength(...e)]),b:s.feedback,c:e.t(s.feedback.length),d:e.o(((...e)=>s.submitFeedback&&s.submitFeedback(...e)))}}],["__scopeId","data-v-56af5836"]]);wx.createPage(o);
