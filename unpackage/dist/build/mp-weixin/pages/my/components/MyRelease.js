"use strict";const t=require("../../../common/vendor.js"),e=require("../../../stores/modules/userStore.js"),s={setup(){const s=e.useUserStore(),o=t.ref([]);return t.onMounted((()=>{(async()=>{try{const e=await t.index.request({url:`http://localhost:3000/api/posts/user/${s.userInfo.users_id}`,method:"GET"});console.log("response",e.data),200===e.statusCode&&"0"===e.data.success?o.value=e.data.data:t.index.showToast({title:"获取发布信息失败",icon:"none"})}catch(e){console.error("获取发布信息错误:",e),t.index.showToast({title:"获取发布信息失败，请稍后再试。",icon:"none"})}})()})),{posts:o,deletePost:async e=>{try{const s=await t.index.request({url:`http://localhost:3000/api/posts/${e}`,method:"DELETE"});200===s.statusCode&&"0"===s.data.success?(o.value=o.value.filter((t=>t.posts_id!==e)),t.index.showToast({title:"删除成功",icon:"success"})):t.index.showToast({title:"删除失败",icon:"none"})}catch(s){console.error("删除发布内容错误:",s),t.index.showToast({title:"删除发布内容失败，请稍后再试。",icon:"none"})}},userStore:s}},onLoad(){this.userStore.loginStatus||(t.index.navigateTo({url:"/pages/login/login"}),t.index.showToast({title:"请先登录！",icon:"none",duration:2e3}))}};const o=t._export_sfc(s,[["render",function(e,s,o,n,a,i){return t.e({a:0===n.posts.length},0===n.posts.length?{}:{b:t.f(n.posts,((e,s,o)=>({a:t.t(e.nickname),b:t.t(e.posts_content),c:t.t(e.tag),d:t.t(e.like_count),e:t.o((t=>n.deletePost(e.posts_id)),e.posts_id),f:e.posts_id})))})}],["__scopeId","data-v-85b5ff8f"]]);wx.createPage(o);
