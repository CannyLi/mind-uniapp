"use strict";const t=require("../../../common/vendor.js"),e=require("../../../stores/modules/userStore.js"),n={setup(){const n=e.useUserStore();n.initUser();const o=t.ref([]);t.onMounted((()=>{(async()=>{try{const e=await t.index.request({url:"http://localhost:3000/api/appointments/user/"+n.userInfo.mobile_phone,method:"GET"});console.log("response.data",e.data),200===e.statusCode&&"0"===e.data.success?o.value=e.data.data:t.index.showToast({title:"获取预约信息失败",icon:"none"})}catch(e){console.error("获取预约信息错误:",e),t.index.showToast({title:"获取预约信息失败，请稍后再试。",icon:"none"})}})()}));return{appointments:o,deleteAppointment:async e=>{try{const n=await t.index.request({url:`http://localhost:3000/api/appointments/${e}`,method:"DELETE"});200===n.statusCode&&"0"===n.data.success?(o.value=o.value.filter((t=>t.appointment_id!==e)),t.index.showToast({title:"预约删除成功",icon:"success"})):t.index.showToast({title:"预约删除失败",icon:"none"})}catch(n){console.error("删除预约信息错误:",n),t.index.showToast({title:"删除预约信息失败，请稍后再试。",icon:"none"})}},userStore:n,formatDate:t=>{if(!t)return"未填写";const e=new Date(t);return`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`}}},onLoad(){this.userStore.loginStatus||(t.index.navigateTo({url:"/pages/login/login"}),t.index.showToast({title:"请先登录！",icon:"none",duration:2e3}))}};const o=t._export_sfc(n,[["render",function(e,n,o,s,a,i){return t.e({a:0===s.appointments.length},0===s.appointments.length?{}:{b:t.f(s.appointments,((e,n,o)=>({a:t.t(e.user_real_name),b:t.t(e.user_mobile_phone),c:t.t(e.studentId),d:t.t(e.college),e:t.t(e.campus),f:t.t(s.formatDate(e.appointmentDate)),g:t.t(e.consultIntention),h:t.o((t=>s.deleteAppointment(e.appointment_id)),e.appointment_id),i:e.appointment_id})))})}],["__scopeId","data-v-846d0011"]]);wx.createPage(o);
